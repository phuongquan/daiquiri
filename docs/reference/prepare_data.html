<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Validate a data frame against a fieldtypes specification, and
prepare for aggregation."><title>Prepare source data — prepare_data • daiquiri</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare source data — prepare_data"><meta property="og:description" content="Validate a data frame against a fieldtypes specification, and
prepare for aggregation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">daiquiri</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/daiquiri.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phuongquan/daiquiri/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepare source data</h1>
      <small class="dont-index">Source: <a href="https://github.com/phuongquan/daiquiri/blob/HEAD/R/sourcedata.R" class="external-link"><code>R/sourcedata.R</code></a></small>
      <div class="d-none name"><code>prepare_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Validate a data frame against a <code><a href="fieldtypes.html">fieldtypes</a></code> specification, and
prepare for aggregation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">prepare_data</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="va">fieldtypes</span>,
  override_columnnames <span class="op">=</span> <span class="cn">FALSE</span>,
  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"NULL"</span><span class="op">)</span>,
  dataset_shortdesc <span class="op">=</span> <span class="cn">NULL</span>,
  showprogress <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p>A data frame</p></dd>
<dt>fieldtypes</dt>
<dd><p><code><a href="fieldtypes.html">fieldtypes</a></code> object specifying names and types
of fields (columns) in the source data. See also
<a href="availablefieldtypes.html">availablefieldtypes</a>.</p></dd>
<dt>override_columnnames</dt>
<dd><p>If FALSE, column names must exist in data frame
and must match the names specified in fieldtypes exactly. If TRUE, column
names in source will be replaced with names in fieldtypes specification.
The specification must therefore contain the columns in the correct order.
Default = FALSE</p></dd>
<dt>na</dt>
<dd><p>vector containing strings that should be interpreted as missing
values, Default = <code>c("","NA","NULL")</code>.</p></dd>
<dt>dataset_shortdesc</dt>
<dd><p>Short description of the dataset being checked. This
will appear on the report. If blank, the name of the data frame object will
be used</p></dd>
<dt>showprogress</dt>
<dd><p>Print progress to console. Default = TRUE</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>sourcedata</code> object</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fieldtypes.html">fieldtypes</a></code>, <code><a href="availablefieldtypes.html">availablefieldtypes</a></code>,
  <code><a href="aggregate_data.html">aggregate_data</a></code>, <code><a href="report_data.html">report_data</a></code>,
  <code><a href="create_report.html">create_report</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">rawdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_data.html">read_data</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_data.csv"</span>, package <span class="op">=</span> <span class="st">"daiquiri"</span><span class="op">)</span>,</span>
<span class="r-in">  delim <span class="op">=</span> <span class="st">","</span>,</span>
<span class="r-in">  col_names <span class="op">=</span> <span class="cn">TRUE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">sourcedataobj</span> <span class="op">&lt;-</span> <span class="fu">prepare_data</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">rawdata</span>,</span>
<span class="r-in">  fieldtypes <span class="op">=</span> <span class="fu"><a href="fieldtypes.html">fieldtypes</a></span><span class="op">(</span>PrescriptionID <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_uniqueidentifier</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">    PrescriptionDate <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_timepoint</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">    AdmissionDate <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_datetime</a></span><span class="op">(</span>includes_time <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span class="r-in">    Drug <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_freetext</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">    Dose <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">    DoseUnit <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_categorical</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">    PatientID <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_ignore</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">    Location <span class="op">=</span> <span class="fu"><a href="availablefieldtypes.html">ft_categorical</a></span><span class="op">(</span>aggregate_by_each_category<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  override_columnnames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>,<span class="st">"NULL"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fieldtypes supplied:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PrescriptionID	&lt;fieldtype_uniqueidentifier&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PrescriptionDate	&lt;fieldtype_timepoint&gt;	options: includes_time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmissionDate	&lt;fieldtype_datetime&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Drug	&lt;fieldtype_freetext&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dose	&lt;fieldtype_numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DoseUnit	&lt;fieldtype_categorical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PatientID	&lt;fieldtype_ignore&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location	&lt;fieldtype_categorical&gt;	options: aggregate_by_each_category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking column names against fieldtypes... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importing source data [NULL]... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking data against fieldtypes... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Selecting relevant warnings... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Identifying nonconformant values... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Checking and removing missing timepoints... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking for duplicates... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sorting data... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loading into sourcedata structure... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PrescriptionID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PrescriptionDate </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AdmissionDate </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Drug </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Dose </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DoseUnit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PatientID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Location </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by T. Phuong Quan, University of Oxford.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

